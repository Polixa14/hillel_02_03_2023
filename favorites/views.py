from django.contrib.auth.decorators import login_requiredfrom django.utils.decorators import method_decoratorfrom django.views.generic import ListView, RedirectViewfrom favorites.forms import AddProductToFavoriteFormfrom favorites.models import FavoriteProductfrom django.urls import reverseclass FavoriteView(ListView):    model = FavoriteProduct    template_name = 'favorite/index.html'    context_object_name = 'favorite_products'    @method_decorator(login_required)    def dispatch(self, request, *args, **kwargs):        return super().dispatch(request, *args, **kwargs)    def get_queryset(self):        return FavoriteProduct.objects.filter(user=self.request.user)class AddToFavoriteProduct(RedirectView):    @method_decorator(login_required)    def dispatch(self, request, *args, **kwargs):        return super().dispatch(request, *args, **kwargs)    def get_redirect_url(self, slug, *args, **kwargs):        return reverse('details', kwargs={'slug': slug})    def post(self, request, *args, **kwargs):        form = AddProductToFavoriteForm(request.POST, user=request.user)        if form.is_valid():            form.save()        return self.get(request, *args, **kwargs)